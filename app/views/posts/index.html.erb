<div><h1 style="margin: auto; text-align:center">Posts</h1></div>

<div class="container">

   <%= form_for :query, url: posts_path, method: :get do |form| %>
    <div class="field">
      <%= form.text_field :text, placeholder: 'Search...', value: params.dig('query', 'text') %>
    </div>

    <div class="field">
      <%= form.label :category %>
      <%= form.select :category, [['Music', 'Music'], ['Science', 'Science'], ['Movies', 'Movies'], ['Gaming', 'Gaming'], ['Anime', 'Anime']],
      include_blank: true, selected: params.dig('query', 'category') %>
       <%# <%= form.select :category_id, @categories.collect {|u| [ u.name, u.id ] } %> 
    </div>

    <div class="actions">
      <%= form.submit 'Search' %>
    </div>
  <% end  %>

    <% @posts.each do |post| %>
     <table class="table table-dark table-striped">
        <tbody>
            <tr scope="row">
              <td>Posted by:</td>
              <td></td>
              <td></td>
              <td><%= User.find(post.user_id).name  %></td>
            </tr>
            <tr scope="row">
                <td><%= Category.find(post.category_id).name %></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr scope="row">
              <td colspan="4"><%= post.title %></td>
            </tr>

            <tr scope="row">
              <td colspan="4"><p style=" overflow: hidden"><%= post.body %></p></td>
            </tr>

            <tr scope="row">
              <td><%= link_to 'Show', post %></td>
                <% if policy(post).update?%>
                  <td><%= link_to 'Edit', edit_post_path(post) %></td>
                <%end%>
                 <% if policy(post).destroy?%>
                 <td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %></td>
                <%end%>
            </tr>
        </tbody>
      </table>
       
    <% end %>
</div>
<br>